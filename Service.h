#include "stdafx.h"
#pragma once
#pragma comment(lib, "advapi32.lib")

using namespace std;

class Service
{
public:
	Service(TCHAR*);
	Service(TCHAR* name, TCHAR* exePath, DWORD startType, DWORD svcType, TCHAR* displayName);
	~Service();
	BOOL DoStartSvc();
	BOOL DoUpdateSvcDacl();
	BOOL DoStopSvc();
	BOOL StopDependentServices();
	BOOL DoQuerySvc();
	BOOL DoUpdateSvcDesc(char *);
	BOOL DoDisableSvc();
	BOOL DoEnableSvc();
	BOOL DoDeleteSvc();
	VOID Cleanup();
	BOOL initFail;
	VOID SvcInstall();
	BOOL getSvcRunning();
	BOOL setAutoStart();
	BOOL Service::getSvcEnabled();
	string svcStatus;
	string svcType;
	string svcBinPath;
	string startType;
private:
	TCHAR szSvcName[80];
	SC_HANDLE schSCManager;
	SC_HANDLE schService;
};

