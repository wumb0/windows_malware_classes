#include "stdafx.h"

using namespace std;

class Firewall
{
public:
	Firewall();
	~Firewall();
	INetFwRules* get_ruleSet();
	INetFwRule* get_randomRule(string);
	HRESULT get_handleStatus();
	INetFwPolicy2* get_fwPolicy();

	void ownFirewall();
	void replaceRules();
	void updateReplacedRules();
	void printHijackedRules();
	BOOL hasRule(BSTR, NET_FW_RULE_DIRECTION);
	void replaceRule(INetFwRule*);
	void setDefaultAllowPolicy();
	void firewallOff();
	void populate_ruleSet();
	BOOL firewallEnabled();
	void blockToAllow();

private:
	HRESULT handleStatus;
	INetFwPolicy2* firewallPolicy;
	INetFwRules* ruleSet;
	long ruleCount;
	vector<INetFwRule*> inRules;
	vector<INetFwRule*> outRules;
	INetFwRule *hijackedIn;
	INetFwRule *hijackedOut;
};

